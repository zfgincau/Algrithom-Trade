═══════════════════════════════════════════════════════════════
                    MT-v6.15 功能需求清单
═══════════════════════════════════════════════════════════════

【一、波动系数调整机制】
------------------------------------------------------------------
1. 波动 >= 400点 → 系数 2.0
2. 波动 >= 350点 → 系数 1.6
3. 波动 >= 300点 → 系数 1.4
4. 波动 >= 250点 → 系数 1.2


【二、趋势判断与反转识别算法】
------------------------------------------------------------------
1. 基础功能：
   - 根据过往趋势判断未来趋势（作为首单下单逻辑）
   - 识别趋势反转信号

2. 决策逻辑：
   - 如果趋势判断可信度大 → 采用趋势判断的下单方向
   - 如果诊断出趋势反转（波动回归）信号 → 采用趋势反转方向

3. 趋势反转识别算法需实现：
   - 检测价格波动回归特征
   - 评估趋势强度和可信度
   - 识别反转信号（如：动量衰减、背离等）


【三、手数序列】
------------------------------------------------------------------
第1单：0.03手
第2单：0.02手
第3单：0.04手
第4单：0.08手
第5单及以后：前一单的2倍手数


【四、休眠机制（基于加单数）】
------------------------------------------------------------------
1. 本轮加单数 = 4单 → 休眠5分钟
2. 本轮加单数 = 5单 → 休眠10分钟
3. 本轮加单数 >= 6单 → 休眠15分钟

4. 冲突处理：
   - 当多个休眠条件同时触发时，采用休眠时间最长的场景


【五、防单边趋势机制（第8单保护）】
------------------------------------------------------------------
1. 触发条件：
   - 已经加到第8单
   - 行情还有单边趋势变化的倾向
   - 价格超过第8单250点

2. 执行策略：
   - 反向开一单第8单双倍手数的单子
   - 停止开新的原方向订单

3. 止盈逻辑：
   - 如果整体盈利≥30美刀 → 立即全局平仓
   - **不休眠**，可以立即开始新一轮交易


【六、临时止盈机制】
------------------------------------------------------------------
1. 触发条件（满足任一即可）：
   - 新加仓单子在1分钟内盈利 >= 40%的加仓间隔点数
   - 新加仓单子在3分钟内盈利 >= 60%的加仓间隔点数

2. 执行流程：
   a) 先将新开的单子止盈平仓
   b) 盈利金额冲减当前轮需要达到的盈利目标
   c) 根据实时计算的间隔执行新的加仓
   d) 新加仓单子手数 = 刚刚临时止盈单子的手数

3. 加仓间隔决策：
   - 实时计算新的加仓间隔
   - 如果新计算间隔 > 当前价格与上一单距离 → 按新计算间隔加仓
   - 如果新计算间隔 < 当前价格与上一单距离 → 按当前价格加仓


【七、单边趋势加速防护】
------------------------------------------------------------------
1. 触发条件：
   - 计算出的加仓间隔 < 200点

2. 检测逻辑：
   - 检查过去5分钟行情
   - 判断是否有逆着本轮开单方向的单边趋势加速

3. 执行策略：
   - 放大加仓间隔
   - 最小放大系数：1.2
   - 最大放大系数：2.0
   - 实际系数根据单边趋势加速率评估


【八、休眠机制优先级】
------------------------------------------------------------------
当多个休眠场景同时触发时：
- 采用休眠时间最长的场景进行休眠

休眠场景包括：
1. 基于加单数的休眠（5分钟/10分钟/15分钟）

注意：第8单保护触发后**不休眠**


═══════════════════════════════════════════════════════════════
                          功能检查清单
═══════════════════════════════════════════════════════════════

□ 波动系数调整机制
□ 趋势判断基础逻辑
□ 趋势反转识别算法
□ 手数序列（0.03, 0.02, 0.04, 0.08, ...）
□ 基于加单数的休眠机制
□ 第8单防单边趋势保护
□ 临时止盈机制
□ 单边趋势加速防护
□ 休眠机制优先级处理

═══════════════════════════════════════════════════════════════

